@implements IDisposable

<div id="demo" style="font-size: 300%;font-weight: bold">@CountdownText</div>

@code {
    private System.Timers.Timer? _timer;
    private DateTime _countDownDate = new DateTime(2024, 12, 20, 17, 0, 0);
    private string CountdownText = string.Empty;

    protected override void OnInitialized()
    {
        // Set up and start the timer
        _timer = new System.Timers.Timer(500); // 1-second interval
        _timer.Elapsed += UpdateCountdown;
        _timer.AutoReset = true;
        _timer.Start();

        // Update the countdown immediately
        UpdateCountdown(null, null);
    }

    private void UpdateCountdown(object? sender, System.Timers.ElapsedEventArgs? e)
    {
        var now = DateTime.Now;
        var distance = _countDownDate - now;

        if (distance.TotalMilliseconds > 0)
        {
            // Calculate days, hours, minutes, and seconds
            var days = distance.Days;
            var hours = distance.Hours;
            var minutes = distance.Minutes;
            var seconds = distance.Seconds;

            CountdownText = $"{days}d {hours}h {minutes}m {seconds}s";
        }
        else
        {
            CountdownText = "OUT NOW";
            _timer?.Stop(); // Stop the timer once expired
        }

        InvokeAsync(StateHasChanged); // Refresh the UI
    }

    public void Dispose()
    {
        _timer?.Dispose(); // Cleanup the timer on component disposal
    }
}